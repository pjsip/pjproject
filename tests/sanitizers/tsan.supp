# Thread Sanitizer suppressions for PJSIP
# Add suppressions here if needed when TSan detects false positives
#
# Disable data race warnings as most are by design or harmless
# Focus on deadlock reports only (e.g., lock-order-inversion)
race:*

# Lock-order-inversion with:
# - pjsip_tsx_layer_find_tsx ../src/pjsip/sip_transaction.c
# - pjsip_tsx_recv_msg ../src/pjsip/sip_transaction.c
# - rt_on_rx_response ../src/test/transport_test.c
deadlock:endpt_on_tx_msg ../src/pjsip/sip_endpoint.c

# Lock-order-inversion with:
# - pj_activesock_start_connect ../src/pj/activesock.c
# - tp_state_callback ../src/pjsip/sip_transport.c
# - rt_on_rx_response ../src/test/transport_test.c
deadlock:stateless_send_transport_cb ../src/pjsip/sip_util.c

# Lock-order-inversion with:
# - tp_state_callback ../src/pjsip/sip_transport.c
deadlock:transport_tcp_test ../src/test/transport_tcp_test.c

# Lock-order-inversion with:
# - udp_shutdown ../src/pjsip/sip_transport_udp.c
deadlock:destroy_transport ../src/pjsip/sip_transport.c
